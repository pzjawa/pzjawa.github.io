---
title: 如何美化你的PowerShell
tags:
  - 美化
  - PowerShell
  - Oh My Posh
categories:
  - 技术
abbrlink: 662d
date: 2024-07-13 00:00:00
cover: https://image.ifeng.asia:5243/files/2/66c413249cd0f.webp
description:
keywords: 'PowerShell,Oh My Posh,美化,Git Bash'
---

## 安装

### PowerShell

本教程适用于`PowerShell`和 `Windows PowerShell`，但我仍然建议你使用更新的`PowerShell`

从`Github`下载安装[PowerShell](https://github.com/PowerShell/powershell/releases)

### Windows Terminal

打开微软商店下载安装

![](https://image.ifeng.asia:5243/files/2/66c32912da36f.webp)

将默认配置文件改为`PowerShell7`

![](https://image.ifeng.asia:5243/files/2/66c329109f7cd.webp)

## 字体

访问 [Nerd Fonts](https://www.nerdfonts.com/font-downloads)官网选择你喜欢的字体，这里推荐使用`JetBrainsMono Nerd Font`

下载解压后全选字体安装

![](https://image.ifeng.asia:5243/files/2/66c32910f12a8.webp)

更改为你安装的字体

![](https://image.ifeng.asia:5243/files/2/66c329119a5ba.webp)

## 配色方案

![](https://image.ifeng.asia:5243/files/2/66c3291166e55.webp)

## 亚克力

![](https://image.ifeng.asia:5243/files/2/66c32911181f9.webp)

## Oh My Posh

### 安装

打开`PowerShell`并运行以下命令：

```powershell
winget install JanDeDobbeleer.OhMyPosh -s winget
```

![](https://image.ifeng.asia:5243/files/2/66c32910d7578.webp)

如图所示则为安装成功

也可以使用微软商店安装

![](https://image.ifeng.asia:5243/files/2/66c32911dc1d9.webp)

### 允许PowerShell运行本地脚本

以**管理员身份**运行`PowerShell`并运行以下命令：

```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope LocalMachine
```

### 配置

依次输入以下命令：

```powershell
New-Item -Path $PROFILE -Type File -Force
notepad $PROFILE
```

在打开的空白配置文件中输入以下内容并保存：

```powershell
oh-my-posh init pwsh | Invoke-Expression
```

### 主题

预览所有主题，选择一个你喜欢的主题

```powershell
Get-PoshThemes
```

也可以在[Oh My Posh](https://ohmyposh.dev/docs/themes)官网查看

运行以下命令：

```powershell
oh-my-posh init pwsh --config "$env:POSH_THEMES_PATH/[theme].omp.json" | Invoke-Expression
```

其中`[theme]`为**主题名**

重新加载配置即可看到主题效果

```powershell
. $PROFILE
```

## Git Bash集成

如果你和我一样不喜欢`Git`的默认终端，可以将`Git Bash`集成到`PowerShell`中

在`Windows Terminal`设置中新建配置文件

- `名称`：**Git Bash**
- `命令`：**%ProgramFiles%\Git\bin\bash.exe --login -i**
- `启动目录`：**%USERPROFILE%**
- `图标`：**%ProgramFiles%\Git\mingw64\share\git\git-for-windows.ico**
